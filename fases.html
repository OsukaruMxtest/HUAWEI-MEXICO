<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fases - PUBG MOBILE COPA HUAWEI MEXICO</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');
        
        :root {
            --primary: #BB0215;
            --primary-bright: #E9072B;
            --secondary: #00683F;
            --secondary-dark: #003F1E;
            --background: #C5C5C5;
            --card-bg: rgba(255, 255, 255, 0.85);
            --card-border: rgba(255, 255, 255, 0.3);
            --text: #1a1a1a;
            --text-secondary: #4a4a4a;
            --text-light: #ffffff;
            --shadow: rgba(0, 0, 0, 0.1);
            --shadow-hover: rgba(0, 0, 0, 0.15);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Poppins', sans-serif;
            color: var(--text);
            min-height: 100vh;
            overflow-x: hidden;
            line-height: 1.6;
            position: relative;
        }

        .video-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            z-index: -2;
        }

        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: -1;
        }
        
        header {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--card-border);
            z-index: 1000;
            padding: 1rem;
            box-shadow: 0 2px 15px var(--shadow);
        }
        
        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--primary);
            text-transform: uppercase;
            letter-spacing: 1px;
            max-width: 70%;
        }
        
        .nav-links {
            display: flex;
            gap: 1.5rem;
        }
        
        .nav-links a {
            color: var(--text);
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s ease;
            position: relative;
            padding: 0.5rem 0;
        }
        
        .nav-links a:hover {
            color: var(--primary);
        }
        
        .nav-links a::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0;
            height: 2px;
            background: var(--primary);
            transition: width 0.3s ease;
        }
        
        .nav-links a:hover::after {
            width: 100%;
        }
        
        main {
            margin-top: 80px;
            padding: 1rem;
            position: relative;
            z-index: 1;
        }
        
        .glass-card {
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--card-border);
            border-radius: 12px;
            padding: 1.2rem;
            box-shadow: 0 8px 25px var(--shadow);
            transition: all 0.3s ease;
        }
        
        .glass-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 35px var(--shadow-hover);
        }

        .text-container {
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            padding: 1.2rem;
            margin-bottom: 1.2rem;
            box-shadow: 0 4px 15px var(--shadow);
            border: 1px solid var(--card-border);
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes slideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        @keyframes blurIn {
            from { filter: blur(10px); opacity: 0; }
            to { filter: blur(0); opacity: 1; }
        }
        
        .fade-in {
            animation: fadeIn 1s ease forwards;
        }
        
        .slide-up {
            animation: slideUp 0.8s ease forwards;
        }
        
        .blur-in {
            animation: blurIn 1s ease forwards;
        }
        
        .section {
            margin-bottom: 1.5rem;
        }
        
        .section-title {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--text);
            border-left: 4px solid var(--primary);
            padding-left: 0.75rem;
        }
        
        .phases-nav {
            display: flex;
            gap: 0.8rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }
        
        .phase-btn {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 10px;
            padding: 0.6rem 1.2rem;
            color: var(--text);
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px var(--shadow);
            font-size: 0.9rem;
            min-height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .phase-btn.active {
            background: var(--primary);
            border-color: var(--primary);
            color: var(--text-light);
        }
        
        .phase-btn:hover:not(.active) {
            background: rgba(187, 2, 21, 0.1);
            transform: translateY(-2px);
        }
        
        .groups-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }
        
        .group-card {
            text-align: center;
            padding: 1.2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            border-radius: 12px;
            min-height: 100px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        
        .group-card.active {
            border: 2px solid var(--primary);
            box-shadow: 0 0 0 2px rgba(187, 2, 21, 0.2);
        }
        
        .group-card:hover {
            transform: translateY(-5px);
        }
        
        .group-name {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--text);
        }
        
        .group-stats {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }
        
        .group-content {
            display: none;
        }
        
        .group-content.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        .maps-tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.2rem;
            flex-wrap: wrap;
        }
        
        .map-tab {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 8px;
            padding: 0.6rem 0.8rem;
            color: var(--text);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.85rem;
            min-height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .map-tab.active {
            background: var(--secondary);
            border-color: var(--secondary);
            color: var(--text-light);
        }
        
        .map-tab:hover:not(.active) {
            background: rgba(0, 104, 63, 0.1);
            transform: translateY(-2px);
        }
        
        .map-content {
            display: none;
        }
        
        .map-content.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        .map-indicator {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            background: var(--secondary);
            color: var(--text-light);
            border-radius: 20px;
            font-size: 0.8rem;
            margin-bottom: 1rem;
        }
        
        .table-container {
            overflow-x: auto;
            border-radius: 10px;
            margin-bottom: 1.2rem;
            box-shadow: 0 4px 15px var(--shadow);
            -webkit-overflow-scrolling: touch;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            background: var(--card-bg);
            border-radius: 10px;
            overflow: hidden;
            min-width: 600px;
        }
        
        th, td {
            padding: 0.6rem 0.8rem;
            text-align: center;
            border-bottom: 1px solid var(--card-border);
            white-space: nowrap;
        }

        th {
            background: rgba(187, 2, 21, 0.1);
            font-weight: 600;
            color: var(--primary);
        }

        table {
            table-layout: auto;
            width: auto;
            min-width: 100%;
        }

        th, td {
            width: auto;
        }
        
        tr:hover {
            background: rgba(0, 0, 0, 0.03);
        }
        
        .mvp-card {
            display: flex;
            align-items: center;
            gap: 1.2rem;
            padding: 1.2rem;
            margin-bottom: 1.2rem;
        }
        
        .mvp-avatar {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.7rem;
            color: var(--text-light);
            flex-shrink: 0;
            overflow: hidden;
        }
        
        .mvp-info h3 {
            font-size: 1.3rem;
            margin-bottom: 0.4rem;
            color: var(--text);
        }
        
        .mvp-stats {
            display: flex;
            gap: 0.8rem;
            margin-top: 0.4rem;
        }
        
        .mvp-stat {
            display: flex;
            flex-direction: column;
        }
        
        .mvp-stat-value {
            font-weight: 600;
            color: var(--primary);
        }
        
        .mvp-stat-label {
            font-size: 0.75rem;
            color: var(--text-secondary);
        }
        
        footer {
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border-top: 1px solid var(--card-border);
            padding: 1.2rem;
            text-align: center;
            color: var(--text-secondary);
            margin-top: 1.5rem;
            box-shadow: 0 -2px 15px var(--shadow);
        }
        
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.05);
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary-bright);
        }
        
        .loading {
            text-align: center;
            padding: 2rem;
            color: var(--text-secondary);
        }
        
        .hidden {
            display: none;
        }

        .team-logo {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            object-fit: cover;
            margin-right: 8px;
            background: #f0f0f0;
            border: 1px solid var(--card-border);
            transition: transform 0.3s ease;
        }

        .team-logo:hover {
            transform: scale(2.5);
            z-index: 10;
            position: relative;
        }

        .player-avatar {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            object-fit: cover;
            background: #f0f0f0;
            border: 2px solid var(--card-border);
            transition: transform 0.3s ease;
        }

        .player-avatar:hover {
            transform: scale(2.5);
            z-index: 10;
            position: relative;
        }

        .clasificado {
            position: relative;
            border: 2px solid var(--secondary) !important;
            box-shadow: 0 0 10px rgba(0, 104, 63, 0.3);
        }

        .clasificado::after {
            content: "✓";
            position: absolute;
            top: 5px;
            right: 5px;
            background: var(--secondary);
            color: var(--text-light);
            width: 18px;
            height: 18px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 11px;
        }

        .maps-content-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
        }

        .mvp-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.2rem;
            margin-bottom: 1.5rem;
        }

        .mvp-map-card {
            display: flex;
            align-items: center;
            gap: 0.8rem;
            padding: 1rem;
        }
        
        .mvp-map-avatar {
            width: 55px;
            height: 55px;
            border-radius: 50%;
            background: var(--secondary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3rem;
            color: var(--text-light);
            flex-shrink: 0;
            overflow: hidden;
        }

        .mvp-map-info h4 {
            font-size: 1rem;
            margin-bottom: 0.2rem;
            color: var(--secondary);
        }

        .mvp-map-info h5 {
            font-size: 0.9rem;
            margin-bottom: 0.2rem;
            color: var(--text);
        }

        .mvp-map-info p {
            color: var(--text-secondary);
            margin-bottom: 0.2rem;
            font-size: 0.85rem;
        }

        .mvp-map-stats {
            display: flex;
            gap: 0.7rem;
            margin-top: 0.3rem;
        }

        .mvp-map-stat {
            display: flex;
            flex-direction: column;
        }

        .mvp-map-stat-value {
            font-weight: 600;
            color: var(--primary);
            font-size: 0.85rem;
        }

        .mvp-map-stat-label {
            font-size: 0.65rem;
            color: var(--text-secondary);
        }

        .longest-kill-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 1.2rem;
            margin-bottom: 1.5rem;
        }

        .longest-kill-card {
            padding: 1rem;
        }

        .longest-kill-card h4 {
            font-size: 1rem;
            margin-bottom: 0.4rem;
            color: var(--secondary);
        }

        .longest-kill-card p {
            margin: 0;
            color: var(--text);
            font-size: 0.9rem;
        }

        .longest-kill-card strong {
            color: var(--primary);
        }

        .player-info-with-avatar {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .mvp-avatar img,
        .mvp-map-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
        }

        .mvp-avatar,
        .mvp-map-avatar {
            transition: transform 0.3s ease;
        }

        .mvp-avatar:hover,
        .mvp-map-avatar:hover {
            transform: scale(2.5);
            z-index: 10;
            position: relative;
        }
        
        .hamburger {
            display: none;
            flex-direction: column;
            cursor: pointer;
            width: 30px;
            height: 21px;
            justify-content: space-between;
            padding: 5px;
            background: transparent;
            border: none;
        }

        .hamburger span {
            width: 100%;
            height: 3px;
            background-color: var(--primary);
            border-radius: 2px;
            transition: all 0.3s ease;
        }

        /* Media Queries para móviles */
        @media (max-width: 768px) {
            header {
                padding: 0.8rem;
            }
            
            .logo {
                font-size: 0.95rem;
                max-width: 65%;
            }
            
            .nav-links {
                position: absolute;
                top: 70px;
                left: 0;
                width: 100%;
                background: var(--card-bg);
                backdrop-filter: blur(10px);
                border-bottom: 1px solid var(--card-border);
                flex-direction: column;
                align-items: center;
                padding: 1rem 0;
                gap: 1rem;
                box-shadow: 0 4px 10px var(--shadow);
                display: none;
            }

            .nav-links.active {
                display: flex;
            }

            .hamburger {
                display: flex;
            }

            .hamburger.active span:nth-child(1) {
                transform: rotate(45deg) translate(6px, 6px);
            }

            .hamburger.active span:nth-child(2) {
                opacity: 0;
            }

            .hamburger.active span:nth-child(3) {
                transform: rotate(-45deg) translate(6px, -6px);
            }
            
            main {
                margin-top: 70px;
                padding: 0.8rem;
            }
            
            .section {
                margin-bottom: 1.2rem;
            }
            
            .section-title {
                font-size: 1.2rem;
            }
            
            .text-container {
                padding: 1rem;
                margin-bottom: 1rem;
            }
            
            .phases-nav {
                gap: 0.5rem;
                margin-bottom: 1rem;
            }
            
            .phase-btn {
                padding: 0.5rem 1rem;
                font-size: 0.85rem;
                min-height: 40px;
            }
            
            .groups-container {
                grid-template-columns: 1fr;
                gap: 0.8rem;
            }
            
            .group-card {
                padding: 1rem;
                min-height: 80px;
            }
            
            .group-name {
                font-size: 1rem;
            }
            
            .group-stats {
                font-size: 0.8rem;
            }
            
            .maps-tabs {
                gap: 0.3rem;
                margin-bottom: 1rem;
            }
            
            .map-tab {
                padding: 0.5rem 0.7rem;
                font-size: 0.8rem;
                min-height: 40px;
            }
            
            .table-container {
                margin-bottom: 1rem;
                font-size: 0.8rem;
            }
            
            th, td {
                padding: 0.5rem 0.6rem;
            }
            
            .mvp-card {
                flex-direction: column;
                text-align: center;
                gap: 1rem;
                padding: 1rem;
            }
            
            .mvp-avatar {
                width: 60px;
                height: 60px;
                font-size: 1.5rem;
            }
            
            .mvp-info h3 {
                font-size: 1.1rem;
            }
            
            .mvp-stats {
                gap: 0.6rem;
            }
            
            .mvp-stat-value {
                font-size: 0.9rem;
            }
            
            .mvp-stat-label {
                font-size: 0.7rem;
            }
            
            .maps-content-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
            
            .mvp-container {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
            
            .mvp-map-card {
                padding: 0.8rem;
            }
            
            .mvp-map-avatar {
                width: 50px;
                height: 50px;
                font-size: 1.2rem;
            }
            
            .mvp-map-info h4 {
                font-size: 0.95rem;
            }
            
            .mvp-map-info h5 {
                font-size: 0.85rem;
            }
            
            .mvp-map-info p {
                font-size: 0.8rem;
            }
            
            .longest-kill-container {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
            
            .longest-kill-card {
                padding: 0.8rem;
            }
            
            .longest-kill-card h4 {
                font-size: 0.95rem;
            }
            
            .longest-kill-card p {
                font-size: 0.85rem;
            }
            
            .team-logo {
                width: 24px;
                height: 24px;
            }
            
            .player-avatar {
                width: 40px;
                height: 40px;
            }
            
            footer {
                padding: 1rem;
                font-size: 0.9rem;
            }
        }
        
        @media (max-width: 480px) {
            .logo {
                font-size: 0.85rem;
            }
            
            .phase-btn {
                font-size: 0.8rem;
                padding: 0.4rem 0.8rem;
            }
            
            .group-name {
                font-size: 0.95rem;
            }
            
            .map-tab {
                font-size: 0.75rem;
                padding: 0.4rem 0.6rem;
            }
            
            th, td {
                padding: 0.4rem 0.5rem;
                font-size: 0.75rem;
            }
        }
    </style>
</head>
<body>
    <video autoplay muted loop class="video-background">
        <source src="https://res.cloudinary.com/dxtvsnw3g/video/upload/v1763772374/fondo_g1hfuz.mp4" type="video/mp4">
        Tu navegador no soporta videos HTML5.
    </video>
    <div class="overlay"></div>
    
    <header>
        <nav>
            <div class="logo">PUBG MOBILE COPA HUAWEI MÉXICO</div>
            <div class="nav-links" id="nav-links">
                <a href="index.html">Inicio</a>
                <a href="grupos.html">Grupos</a>
                <a href="fases.html" style="color: var(--primary);">Fases</a>
                <a href="tablas.html">Tabla</a>
                <a href="equipos.html">Equipos</a>
                <a href="jugadores.html">Jugadores</a>
                <a href="mapas.html">Mapas</a>
            </div>
            <button class="hamburger" id="hamburger">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </nav>
    </header>
    
    <main>
        <div class="section fade-in">
            <div class="text-container">
                <h1 class="section-title">Fases del Torneo</h1>
                <p>Selecciona una fase para ver los grupos y estadísticas detalladas.</p>
            </div>
        </div>
        
        <div class="section slide-up">
            <div class="text-container">
                <h2 class="section-title">Navegación por Fases</h2>
                <div class="phases-nav" id="phases-nav">
                    <div class="loading">Cargando fases...</div>
                </div>
            </div>
        </div>
        
        <div class="section slide-up hidden" id="groups-section">
            <div class="text-container">
                <h2 class="section-title">Grupos de la Fase</h2>
                <div class="groups-container" id="groups-container">
                </div>
            </div>
        </div>
        
        <div class="section slide-up hidden" id="group-content-section">
        </div>
    </main>
    
    <footer>
        <p>PUBG MOBILE COPA HUAWEI MEXICO - Todos los derechos reservados</p>
    </footer>

    <script>
        // El resto del código JavaScript permanece igual
        let tournamentData = {};
        let currentPhase = null;
        let currentGroup = null;
        let currentMap = null;
        let clasificados = [];
        let teamLogoCache = {};
        let uidToPlayerMap = {};
        
        const mapNames = {
            'M1': 'Erangel',
            'M2': 'Miramar', 
            'M3': 'Sanhok',
            'M4': 'Erangel',
            'M5': 'Miramar',
            'M6': 'Sanhok',
            'M7': 'Erangel',
            'M8': 'Miramar',
            'M9': 'Sanhok'
        };
        
        const phasesStructure = [
            { name: 'Clasificatorias', path: 'data/clasificatorias/', groups: ['GRUPO A', 'GRUPO B', 'GRUPO C', 'GRUPO D'], maps: ['M1', 'M2', 'M3', 'M4', 'M5', 'M6', 'M7', 'M8', 'M9'] },
            { name: 'Semifinal', path: 'data/semifinal/', groups: ['SEMIFINAL 1', 'SEMIFINAL 2'], maps: ['M1', 'M2', 'M3'] },
            { name: 'Final', path: 'data/final/', groups: ['FINAL'], maps: ['M1', 'M2', 'M3', 'M4'] }
        ];

        async function loadUidMap() {
            try {
                const response = await fetch('data/uid/uid.csv');
                if (!response.ok) return;
                
                const csvText = await response.text();
                const lines = csvText.split('\n');
                
                for (let i = 1; i < lines.length; i++) {
                    if (lines[i].trim() === '') continue;
                    const [uid, jugador] = lines[i].split('|').map(s => s.trim());
                    if (uid && jugador) {
                        uidToPlayerMap[uid] = jugador;
                    }
                }
            } catch (error) {
                console.warn('No se pudo cargar el mapeo de UID:', error);
            }
        }

        function getPlayerNameByUid(uid, originalName) {
            return uidToPlayerMap[uid] || originalName;
        }

        function getPlayerImageByUid(uid) {
            if (!uid) return 'data/logos/jugadores/default.png';
            return `data/logos/jugadores/${uid}.png`;
        }

        function getTeamLogo(teamName) {
            if (!teamName || !teamName.trim()) {
                console.warn('Nombre de equipo vacío');
                return 'data/logos/equipos/default.png';
            }
            
            const safeName = teamName.replace(/[^\w\s-]/g, "").trim();
            if (!safeName) {
                console.warn('Nombre sanitizado vacío:', teamName);
                return 'data/logos/equipos/default.png';
            }
            
            const logoPath = `data/logos/equipos/${safeName}.png`;
            console.log('Logo generado para', teamName, ':', logoPath);
            return logoPath;
        }

        async function loadClasificados() {
            try {
                const response = await fetch('data/clasificatorias/clasificados.csv');
                if (!response.ok) return;
                
                const csvText = await response.text();
                const lines = csvText.split('\n');
                
                for (let i = 1; i < lines.length; i++) {
                    if (lines[i].trim() === '') continue;
                    const values = lines[i].split(',');
                    if (values[0] && values[0].trim()) {
                        clasificados.push(values[0].trim());
                    }
                }
            } catch (error) {
                console.warn('No se pudo cargar clasificados:', error);
            }
        }
        
        async function loadTournamentData() {
            try {
                await loadClasificados();
                
                await loadUidMap();
                
                for (const phase of phasesStructure) {
                    tournamentData[phase.name] = {};
                    
                    for (const group of phase.groups) {
                        tournamentData[phase.name][group] = {};
                        
                        for (const map of phase.maps) {
                            const csvPath = `${phase.path}${group}/${map}.csv`;
                            await loadCSVFile(csvPath, phase.name, group, map);
                        }
                    }
                }
                
                updatePhasesNavigation();
                
            } catch (error) {
                console.error('Error cargando datos:', error);
                document.getElementById('phases-nav').innerHTML = '<div class="loading">Error cargando datos del torneo</div>';
            }
        }
        
        async function loadCSVFile(filePath, phase, group, map) {
            try {
                const response = await fetch(filePath + "?nocache=" + Date.now());
                if (!response.ok) {
                    return;
                }
                
                const csvText = await response.text();
                const lines = csvText.split('\n');
                
                const headers = lines[0].split(',');
                
                tournamentData[phase][group][map] = {
                    teams: {},
                    players: [],
                    mapName: mapNames[map] || map
                };
                
                for (let i = 1; i < lines.length; i++) {
                    if (lines[i].trim() === '') continue;
                    
                    const values = lines[i].split(',');
                    const playerData = {};
                    
                    headers.forEach((header, index) => {
                        playerData[header.trim()] = values[index] ? values[index].trim() : '';
                    });
                    
                    playerData.kills = parseInt(playerData['Número de Bajas']) || 0;
                    playerData.damage = parseFloat(playerData['Daño']) || 0;
                    playerData.headshots = parseInt(playerData['Número de Headshots']) || 0;
                    playerData.assists = parseInt(playerData['Asistencias']) || 0;
                    playerData.rank = parseInt(playerData['Rango']) || 0;
                    playerData.maxKillDistance = parseFloat(playerData['Máxima Distancia de Baja']) || 0;
                    playerData.survivalTime = parseFloat(playerData['Tiempo de Supervivencia']) || 0;
                    playerData.accuracy = parseFloat(playerData['Accuracy(%)']) || 0;
                    
                    playerData.phase = phase;
                    playerData.group = group;
                    playerData.map = map;
                    
                    playerData.uid = playerData['UID'] || '';
                    playerData.realName = getPlayerNameByUid(playerData.uid, playerData['Nombre del Jugador']);
                    
                    tournamentData[phase][group][map].players.push(playerData);
                    
                    const teamName = playerData['Nombre del Equipo'];
                    if (!tournamentData[phase][group][map].teams[teamName]) {
                        const logo = getTeamLogo(teamName);
                        tournamentData[phase][group][map].teams[teamName] = {
                            name: teamName,
                            players: [],
                            kills: 0,
                            damage: 0,
                            rank: playerData.rank,
                            wwcd: playerData.rank === 1 ? 1 : 0,
                            logo: logo
                        };
                    }
                    
                    tournamentData[phase][group][map].teams[teamName].players.push(playerData);
                    tournamentData[phase][group][map].teams[teamName].kills += playerData.kills;
                    tournamentData[phase][group][map].teams[teamName].damage += playerData.damage;
                }
                
            } catch (error) {
                console.warn(`No se pudo cargar ${filePath}:`, error);
            }
        }
        
        function updatePhasesNavigation() {
            const phasesNav = document.getElementById('phases-nav');
            phasesNav.innerHTML = '';
            
            let hasData = false;
            
            phasesStructure.forEach(phase => {
                let phaseHasData = false;
                for (const group of phase.groups) {
                    if (tournamentData[phase.name] && tournamentData[phase.name][group]) {
                        for (const map of phase.maps) {
                            if (tournamentData[phase.name][group][map] && 
                                tournamentData[phase.name][group][map].players.length > 0) {
                                phaseHasData = true;
                                break;
                            }
                        }
                    }
                    if (phaseHasData) break;
                }
                
                if (phaseHasData) {
                    hasData = true;
                    const phaseBtn = document.createElement('button');
                    phaseBtn.className = 'phase-btn';
                    phaseBtn.textContent = phase.name;
                    phaseBtn.addEventListener('click', () => selectPhase(phase.name));
                    phasesNav.appendChild(phaseBtn);
                }
            });
            
            if (!hasData) {
                phasesNav.innerHTML = '<div class="loading">No se encontraron datos de fases</div>';
            } else {
                const firstPhaseBtn = phasesNav.querySelector('.phase-btn');
                if (firstPhaseBtn) {
                    firstPhaseBtn.click();
                }
            }
        }
        
        function selectPhase(phaseName) {
            currentPhase = phaseName;
            
            document.querySelectorAll('.phase-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            document.getElementById('groups-section').classList.remove('hidden');
            
            updateGroups(phaseName);
        }
        
        function updateGroups(phaseName) {
            const groupsContainer = document.getElementById('groups-container');
            groupsContainer.innerHTML = '';
            
            const phase = phasesStructure.find(p => p.name === phaseName);
            if (!phase) return;
            
            let hasGroupData = false;
            
            phase.groups.forEach(groupName => {
                let groupHasData = false;
                for (const map of phase.maps) {
                    if (tournamentData[phaseName] && 
                        tournamentData[phaseName][groupName] && 
                        tournamentData[phaseName][groupName][map] &&
                        tournamentData[phaseName][groupName][map].players.length > 0) {
                        groupHasData = true;
                        break;
                    }
                }
                
                if (groupHasData) {
                    hasGroupData = true;
                    const groupCard = document.createElement('div');
                    groupCard.className = 'glass-card group-card';
                    groupCard.addEventListener('click', () => selectGroup(phaseName, groupName));
                    
                    const groupNameEl = document.createElement('div');
                    groupNameEl.className = 'group-name';
                    groupNameEl.textContent = groupName;
                    
                    const groupStats = document.createElement('div');
                    groupStats.className = 'group-stats';
                    
                    let matchCount = 0;
                    for (const map of phase.maps) {
                        if (tournamentData[phaseName] && 
                            tournamentData[phaseName][groupName] && 
                            tournamentData[phaseName][groupName][map] &&
                            tournamentData[phaseName][groupName][map].players.length > 0) {
                            matchCount++;
                        }
                    }
                    
                    groupStats.textContent = `${matchCount} partidas`;
                    
                    groupCard.appendChild(groupNameEl);
                    groupCard.appendChild(groupStats);
                    groupsContainer.appendChild(groupCard);
                }
            });
            
            if (!hasGroupData) {
                groupsContainer.innerHTML = '<div class="loading">No se encontraron datos para los grupos de esta fase</div>';
            } else {
                const firstGroupCard = groupsContainer.querySelector('.group-card');
                if (firstGroupCard) {
                    firstGroupCard.click();
                }
            }
        }
        
        function selectGroup(phaseName, groupName) {
            currentPhase = phaseName;
            currentGroup = groupName;
            
            document.querySelectorAll('.group-card').forEach(card => {
                card.classList.remove('active');
            });
            event.target.classList.add('active');
            
            showGroupContent(phaseName, groupName);
        }
        
        function showGroupContent(phaseName, groupName) {
            const contentSection = document.getElementById('group-content-section');
            contentSection.classList.remove('hidden');
            
            const groupStats = calculateGroupStats(phaseName, groupName);
            
            contentSection.innerHTML = `
                <div class="text-container">
                    <h2 class="section-title">${groupName} - ${phaseName}</h2>
                </div>
                
                <div class="section">
                    <div class="text-container">
                        <h3 class="section-title">MVP por Mapa</h3>
                        <div class="mvp-container">
                            <div class="glass-card mvp-card">
                                <div class="mvp-avatar">
                                    <img src="${getPlayerImageByUid(groupStats.mvp.general.uid)}" alt="${groupStats.mvp.general.realName}" onerror="this.src='data/logos/jugadores/default.png'">
                                </div>
                                <div class="mvp-info">
                                    <h3>MVP General</h3>
                                    <h4>${groupStats.mvp.general.realName}</h4>
                                    <p>${groupStats.mvp.general.team}</p>
                                    <div class="mvp-stats">
                                        <div class="mvp-stat">
                                            <span class="mvp-stat-value">${groupStats.mvp.general.kills}</span>
                                            <span class="mvp-stat-label">Bajas</span>
                                        </div>
                                        <div class="mvp-stat">
                                            <span class="mvp-stat-value">${Math.round(groupStats.mvp.general.damage)}</span>
                                            <span class="mvp-stat-label">Daño</span>
                                        </div>
                                        <div class="mvp-stat">
                                            <span class="mvp-stat-value">${groupStats.mvp.general.headshots}</span>
                                            <span class="mvp-stat-label">Headshots</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="glass-card mvp-map-card">
                                <div class="mvp-map-avatar">
                                    <img src="${getPlayerImageByUid(groupStats.mvp.Erangel.uid)}" alt="${groupStats.mvp.Erangel.realName}" onerror="this.src='data/logos/jugadores/default.png'">
                                </div>
                                <div class="mvp-map-info">
                                    <h4>MVP Erangel</h4>
                                    <h5>${groupStats.mvp.Erangel.realName}</h5>
                                    <p>${groupStats.mvp.Erangel.team}</p>
                                    <div class="mvp-map-stats">
                                        <div class="mvp-map-stat">
                                            <span class="mvp-map-stat-value">${groupStats.mvp.Erangel.kills}</span>
                                            <span class="mvp-map-stat-label">Bajas</span>
                                        </div>
                                        <div class="mvp-map-stat">
                                            <span class="mvp-map-stat-value">${Math.round(groupStats.mvp.Erangel.damage)}</span>
                                            <span class="mvp-map-stat-label">Daño</span>
                                        </div>
                                        <div class="mvp-map-stat">
                                            <span class="mvp-map-stat-value">${groupStats.mvp.Erangel.headshots}</span>
                                            <span class="mvp-map-stat-label">HS</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="glass-card mvp-map-card">
                                <div class="mvp-map-avatar">
                                    <img src="${getPlayerImageByUid(groupStats.mvp.Miramar.uid)}" alt="${groupStats.mvp.Miramar.realName}" onerror="this.src='data/logos/jugadores/default.png'">
                                </div>
                                <div class="mvp-map-info">
                                    <h4>MVP Miramar</h4>
                                    <h5>${groupStats.mvp.Miramar.realName}</h5>
                                    <p>${groupStats.mvp.Miramar.team}</p>
                                    <div class="mvp-map-stats">
                                        <div class="mvp-map-stat">
                                            <span class="mvp-map-stat-value">${groupStats.mvp.Miramar.kills}</span>
                                            <span class="mvp-map-stat-label">Bajas</span>
                                        </div>
                                        <div class="mvp-map-stat">
                                            <span class="mvp-map-stat-value">${Math.round(groupStats.mvp.Miramar.damage)}</span>
                                            <span class="mvp-map-stat-label">Daño</span>
                                        </div>
                                        <div class="mvp-map-stat">
                                            <span class="mvp-map-stat-value">${groupStats.mvp.Miramar.headshots}</span>
                                            <span class="mvp-map-stat-label">HS</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="glass-card mvp-map-card">
                                <div class="mvp-map-avatar">
                                    <img src="${getPlayerImageByUid(groupStats.mvp.Sanhok.uid)}" alt="${groupStats.mvp.Sanhok.realName}" onerror="this.src='data/logos/jugadores/default.png'">
                                </div>
                                <div class="mvp-map-info">
                                    <h4>MVP Sanhok</h4>
                                    <h5>${groupStats.mvp.Sanhok.realName}</h5>
                                    <p>${groupStats.mvp.Sanhok.team}</p>
                                    <div class="mvp-map-stats">
                                        <div class="mvp-map-stat">
                                            <span class="mvp-map-stat-value">${groupStats.mvp.Sanhok.kills}</span>
                                            <span class="mvp-map-stat-label">Bajas</span>
                                        </div>
                                        <div class="mvp-map-stat">
                                            <span class="mvp-map-stat-value">${Math.round(groupStats.mvp.Sanhok.damage)}</span>
                                            <span class="mvp-map-stat-label">Daño</span>
                                        </div>
                                        <div class="mvp-map-stat">
                                            <span class="mvp-map-stat-value">${groupStats.mvp.Sanhok.headshots}</span>
                                            <span class="mvp-map-stat-label">HS</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="section">
                    <div class="text-container">
                        <h3 class="section-title">Eliminación Más Lejana por Mapa</h3>
                        <div class="longest-kill-container">
                            <div class="glass-card longest-kill-card">
                                <h4>General</h4>
                                <div class="player-info-with-avatar">
                                    <img src="${getPlayerImageByUid(groupStats.longestKill.general.uid)}" alt="${groupStats.longestKill.general.realName}" class="player-avatar" onerror="this.src='data/logos/jugadores/default.png'">
                                    <div>
                                        <p><strong>${groupStats.longestKill.general.realName}</strong> (${groupStats.longestKill.general.team})</p>
                                        <p>${groupStats.longestKill.general.distance}m</p>
                                    </div>
                                </div>
                            </div>
                            <div class="glass-card longest-kill-card">
                                <h4>Erangel</h4>
                                <div class="player-info-with-avatar">
                                    <img src="${getPlayerImageByUid(groupStats.longestKill.Erangel.uid)}" alt="${groupStats.longestKill.Erangel.realName}" class="player-avatar" onerror="this.src='data/logos/jugadores/default.png'">
                                    <div>
                                        <p><strong>${groupStats.longestKill.Erangel.realName}</strong> (${groupStats.longestKill.Erangel.team})</p>
                                        <p>${groupStats.longestKill.Erangel.distance}m</p>
                                    </div>
                                </div>
                            </div>
                            <div class="glass-card longest-kill-card">
                                <h4>Miramar</h4>
                                <div class="player-info-with-avatar">
                                    <img src="${getPlayerImageByUid(groupStats.longestKill.Miramar.uid)}" alt="${groupStats.longestKill.Miramar.realName}" class="player-avatar" onerror="this.src='data/logos/jugadores/default.png'">
                                    <div>
                                        <p><strong>${groupStats.longestKill.Miramar.realName}</strong> (${groupStats.longestKill.Miramar.team})</p>
                                        <p>${groupStats.longestKill.Miramar.distance}m</p>
                                    </div>
                                </div>
                            </div>
                            <div class="glass-card longest-kill-card">
                                <h4>Sanhok</h4>
                                <div class="player-info-with-avatar">
                                    <img src="${getPlayerImageByUid(groupStats.longestKill.Sanhok.uid)}" alt="${groupStats.longestKill.Sanhok.realName}" class="player-avatar" onerror="this.src='data/logos/jugadores/default.png'">
                                    <div>
                                        <p><strong>${groupStats.longestKill.Sanhok.realName}</strong> (${groupStats.longestKill.Sanhok.team})</p>
                                        <p>${groupStats.longestKill.Sanhok.distance}m</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="section">
                    <div class="text-container">
                        <h3 class="section-title">Tabla de Posiciones</h3>
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>POS</th>
                                        <th></th>
                                        <th>Equipo</th>
                                        <th>Puntos por posición</th>
                                        <th>Puntos por Eliminación</th>
                                        <th>Total</th>
                                        <th>WWCD</th>
                                        <th>Daño</th>
                                    </tr>
                                </thead>
                                <tbody id="group-standings-body">
                                    <!-- Las filas se cargarán dinámicamente -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <div class="section">
                    <div class="text-container">
                        <h3 class="section-title">Partidas por Mapa</h3>
                        <div class="maps-tabs" id="maps-tabs">
                            <!-- Los tabs de mapas se cargarán dinámicamente -->
                        </div>
                        
                        <div id="maps-content">
                            <!-- El contenido de los mapas se cargará dinámicamente -->
                        </div>
                    </div>
                </div>
            `;
            
            fillGroupStandings(groupStats.standings);
            
            showMapsTabs(phaseName, groupName);
        }
        
        function calculateGroupStats(phaseName, groupName) {
            const phase = phasesStructure.find(p => p.name === phaseName);
            const stats = {
                standings: [],
                mvp: {
                    general: { realName: 'N/A', team: 'N/A', kills: 0, damage: 0, headshots: 0, uid: '' },
                    Erangel: { realName: 'N/A', team: 'N/A', kills: 0, damage: 0, headshots: 0, uid: '' },
                    Miramar: { realName: 'N/A', team: 'N/A', kills: 0, damage: 0, headshots: 0, uid: '' },
                    Sanhok: { realName: 'N/A', team: 'N/A', kills: 0, damage: 0, headshots: 0, uid: '' }
                },
                longestKill: {
                    general: { realName: 'N/A', team: 'N/A', distance: 0, uid: '' },
                    Erangel: { realName: 'N/A', team: 'N/A', distance: 0, uid: '' },
                    Miramar: { realName: 'N/A', team: 'N/A', distance: 0, uid: '' },
                    Sanhok: { realName: 'N/A', team: 'N/A', distance: 0, uid: '' }
                }
            };
            
            const teamStats = {};
            const playerStats = {
                general: {},
                Erangel: {},
                Miramar: {},
                Sanhok: {}
            };
            
            phase.maps.forEach(map => {
                if (tournamentData[phaseName] && 
                    tournamentData[phaseName][groupName] && 
                    tournamentData[phaseName][groupName][map]) {
                    
                    const mapData = tournamentData[phaseName][groupName][map];
                    const mapRealName = mapNames[map];
                    
                    Object.values(mapData.teams).forEach(team => {
                        if (!teamStats[team.name]) {
                            teamStats[team.name] = {
                                name: team.name,
                                logo: team.logo,
                                positionPoints: 0,
                                eliminationPoints: 0,
                                totalPoints: 0,
                                wwcd: 0,
                                damage: 0,
                                bestRank: 99,
                                lastMatchRank: 99
                            };
                        }
                        
                        teamStats[team.name].eliminationPoints += team.kills;
                        teamStats[team.name].damage += team.damage;
                        teamStats[team.name].wwcd += team.wwcd;
                        
                        const positionPoints = calculatePositionPoints(team.rank);
                        teamStats[team.name].positionPoints += positionPoints;
                        
                        if (team.rank < teamStats[team.name].bestRank) {
                            teamStats[team.name].bestRank = team.rank;
                        }
                        
                        teamStats[team.name].lastMatchRank = team.rank;
                    });
                    
                    mapData.players.forEach(player => {
                        const playerName = player['Nombre del Jugador'];
                        const playerRealName = player.realName;
                        const teamName = player['Nombre del Equipo'];
                        const playerUID = player.uid;
                        
                        if (!playerStats.general[playerName]) {
                            playerStats.general[playerName] = {
                                realName: playerRealName,
                                name: playerName,
                                team: teamName,
                                uid: playerUID,
                                kills: 0,
                                damage: 0,
                                headshots: 0,
                                assists: 0,
                                maxKillDistance: 0
                            };
                        }
                        
                        playerStats.general[playerName].kills += player.kills;
                        playerStats.general[playerName].damage += player.damage;
                        playerStats.general[playerName].headshots += player.headshots;
                        playerStats.general[playerName].assists += player.assists;
                        
                        if (player.maxKillDistance > playerStats.general[playerName].maxKillDistance) {
                            playerStats.general[playerName].maxKillDistance = player.maxKillDistance;
                        }
                        
                        if (!playerStats[mapRealName][playerName]) {
                            playerStats[mapRealName][playerName] = {
                                realName: playerRealName,
                                name: playerName,
                                team: teamName,
                                uid: playerUID,
                                kills: 0,
                                damage: 0,
                                headshots: 0,
                                assists: 0,
                                maxKillDistance: 0
                            };
                        }
                        
                        playerStats[mapRealName][playerName].kills += player.kills;
                        playerStats[mapRealName][playerName].damage += player.damage;
                        playerStats[mapRealName][playerName].headshots += player.headshots;
                        playerStats[mapRealName][playerName].assists += player.assists;
                        
                        if (player.maxKillDistance > playerStats[mapRealName][playerName].maxKillDistance) {
                            playerStats[mapRealName][playerName].maxKillDistance = player.maxKillDistance;
                        }
                    });
                }
            });
            
            Object.values(teamStats).forEach(team => {
                team.totalPoints = team.positionPoints + team.eliminationPoints;
            });
            
            stats.standings = Object.values(teamStats).sort((a, b) => {
                if (b.totalPoints !== a.totalPoints) return b.totalPoints - a.totalPoints;
                if (b.wwcd !== a.wwcd) return b.wwcd - a.wwcd;
                if (b.positionPoints !== a.positionPoints) return b.positionPoints - a.positionPoints;
                if (b.eliminationPoints !== a.eliminationPoints) return b.eliminationPoints - a.eliminationPoints;
                return a.lastMatchRank - b.lastMatchRank;
            });
            
            let mvpGeneral = null;
            Object.values(playerStats.general).forEach(player => {
                if (!mvpGeneral || 
                    player.kills > mvpGeneral.kills || 
                    (player.kills === mvpGeneral.kills && player.damage > mvpGeneral.damage) ||
                    (player.kills === mvpGeneral.kills && player.damage === mvpGeneral.damage && player.assists > mvpGeneral.assists)) {
                    mvpGeneral = player;
                }
            });
            
            if (mvpGeneral) {
                stats.mvp.general = mvpGeneral;
            }
            
            ['Erangel', 'Miramar', 'Sanhok'].forEach(mapName => {
                let mvpMap = null;
                Object.values(playerStats[mapName]).forEach(player => {
                    if (!mvpMap || 
                        player.kills > mvpMap.kills || 
                        (player.kills === mvpMap.kills && player.damage > mvpMap.damage) ||
                        (player.kills === mvpMap.kills && player.damage === mvpMap.damage && player.assists > mvpMap.assists)) {
                        mvpMap = player;
                    }
                });
                
                if (mvpMap) {
                    stats.mvp[mapName] = mvpMap;
                }
            });
            
            let longestKillGeneral = null;
            Object.values(playerStats.general).forEach(player => {
                if (!longestKillGeneral || player.maxKillDistance > longestKillGeneral.maxKillDistance) {
                    longestKillGeneral = player;
                }
            });
            
            if (longestKillGeneral) {
                stats.longestKill.general = {
                    realName: longestKillGeneral.realName,
                    player: longestKillGeneral.name,
                    team: longestKillGeneral.team,
                    distance: Math.round(longestKillGeneral.maxKillDistance),
                    uid: longestKillGeneral.uid
                };
            }
            
            ['Erangel', 'Miramar', 'Sanhok'].forEach(mapName => {
                let longestKillMap = null;
                Object.values(playerStats[mapName]).forEach(player => {
                    if (!longestKillMap || player.maxKillDistance > longestKillMap.maxKillDistance) {
                        longestKillMap = player;
                    }
                });
                
                if (longestKillMap) {
                    stats.longestKill[mapName] = {
                        realName: longestKillMap.realName,
                        player: longestKillMap.name,
                        team: longestKillMap.team,
                        distance: Math.round(longestKillMap.maxKillDistance),
                        uid: longestKillMap.uid
                    };
                }
            });
            
            return stats;
        }
        
        function calculatePositionPoints(rank) {
            const pointsMap = {
                1: 10, 2: 6, 3: 5, 4: 4, 5: 3, 6: 2, 7: 2, 8: 1
            };
            return pointsMap[rank] || 0;
        }
        
        function fillGroupStandings(standings) {
            const tbody = document.getElementById('group-standings-body');
            tbody.innerHTML = '';
            
            standings.forEach((team, index) => {
                const row = document.createElement('tr');
                
                const isClasificado = clasificados.includes(team.name);
                if (isClasificado) {
                    row.classList.add('clasificado');
                }
                
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td><img src="${team.logo}" alt="${team.name}" class="team-logo" onerror="this.onerror=null; this.src='data/logos/equipos/default.png?v=' + Date.now()"></td>
                    <td>${team.name}</td>
                    <td>${team.positionPoints}</td>
                    <td>${team.eliminationPoints}</td>
                    <td>${team.totalPoints}</td>
                    <td>${team.wwcd}</td>
                    <td>${Math.round(team.damage)}</td>
                `;
                tbody.appendChild(row);
            });
        }
        
        function showMapsTabs(phaseName, groupName) {
            const phase = phasesStructure.find(p => p.name === phaseName);
            const mapsTabs = document.getElementById('maps-tabs');
            const mapsContent = document.getElementById('maps-content');
            
            mapsTabs.innerHTML = '';
            mapsContent.innerHTML = '';
            
            let hasMapData = false;
            
            phase.maps.forEach(map => {
                if (tournamentData[phaseName] && 
                    tournamentData[phaseName][groupName] && 
                    tournamentData[phaseName][groupName][map] &&
                    tournamentData[phaseName][groupName][map].players.length > 0) {
                    
                    hasMapData = true;
                    
                    const mapTab = document.createElement('button');
                    mapTab.className = 'map-tab';
                    mapTab.textContent = mapNames[map] || map;
                    mapTab.addEventListener('click', () => showMapContent(phaseName, groupName, map));
                    mapsTabs.appendChild(mapTab);
                    
                    const mapContent = document.createElement('div');
                    mapContent.className = 'map-content';
                    mapContent.id = `map-${map}-content`;
                    mapsContent.appendChild(mapContent);
                }
            });
            
            if (hasMapData) {
                const firstMapTab = mapsTabs.querySelector('.map-tab');
                if (firstMapTab) {
                    firstMapTab.click();
                }
            } else {
                mapsContent.innerHTML = '<div class="loading">No se encontraron datos de mapas para este grupo</div>';
            }
        }
        
        function showMapContent(phaseName, groupName, map) {
            currentMap = map;
            
            document.querySelectorAll('.map-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
            
            document.querySelectorAll('.map-content').forEach(content => {
                content.classList.remove('active');
            });
            
            const mapContent = document.getElementById(`map-${map}-content`);
            mapContent.classList.add('active');
            
            const mapData = tournamentData[phaseName][groupName][map];
            
            mapContent.innerHTML = `
                <div class="map-indicator">${mapNames[map] || map}</div>
                
                <div class="maps-content-grid">
                    <div class="section">
                        <div class="text-container">
                            <h4 class="section-title">Equipos - ${mapNames[map] || map}</h4>
                            <div class="table-container">
                                <table>
                                    <thead>
                                        <tr>
                                            <th></th>
                                            <th>Equipo</th>
                                            <th>Posición</th>
                                            <th>Bajas</th>
                                            <th>Daño</th>
                                        </tr>
                                    </thead>
                                    <tbody id="map-teams-body-${map}">
                                        <!-- Las filas se cargarán dinámicamente -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    
                    <div class="section">
                        <div class="text-container">
                            <h4 class="section-title">Jugadores - ${mapNames[map] || map}</h4>
                            <div class="table-container">
                                <table>
                                    <thead>
                                        <tr>
                                            <th></th>
                                            <th>Jugador</th>
                                            <th>Equipo</th>
                                            <th>Bajas</th>
                                            <th>Daño</th>
                                            <th>Headshots</th>
                                            <th>Asistencias</th>
                                        </tr>
                                    </thead>
                                    <tbody id="map-players-body-${map}">
                                        <!-- Las filas se cargarán dinámicamente -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            fillMapTeamsTable(map, mapData.teams);
            
            fillMapPlayersTable(map, mapData.players);
        }
        
        function fillMapTeamsTable(map, teams) {
            const tbody = document.getElementById(`map-teams-body-${map}`);
            tbody.innerHTML = '';
            
            const teamsArray = Object.values(teams).sort((a, b) => a.rank - b.rank);
            
            teamsArray.forEach(team => {
                const row = document.createElement('tr');
                
                const isClasificado = clasificados.includes(team.name);
                if (isClasificado) {
                    row.classList.add('clasificado');
                }
                
                row.innerHTML = `
                    <td><img src="${team.logo}" alt="${team.name}" class="team-logo" onerror="this.onerror=null; this.src='data/logos/equipos/default.png?v=' + Date.now()"></td>
                    <td>${team.name}</td>
                    <td>${team.rank}</td>
                    <td>${team.kills}</td>
                    <td>${Math.round(team.damage)}</td>
                `;
                tbody.appendChild(row);
            });
        }
        
        function fillMapPlayersTable(map, players) {
            const tbody = document.getElementById(`map-players-body-${map}`);
            tbody.innerHTML = '';
            
            const sortedPlayers = [...players].sort((a, b) => 
                b.kills - a.kills ||
                b.damage - a.damage ||
                b.headshots - a.headshots ||
                b.assists - a.assists
            );
            
            sortedPlayers.forEach(player => {
                const row = document.createElement('tr');
                const playerImage = getPlayerImageByUid(player.uid);
                row.innerHTML = `
                    <td><img src="${playerImage}" alt="${player.realName}" class="team-logo" onerror="this.src='data/logos/jugadores/default.png'"></td>
                    <td>${player.realName}</td>
                    <td>${player['Nombre del Equipo']}</td>
                    <td>${player.kills}</td>
                    <td>${Math.round(player.damage)}</td>
                    <td>${player.headshots}</td>
                    <td>${player.assists}</td>
                `;
                tbody.appendChild(row);
            });
        }
        
        function setupMobileMenu() {
            const hamburger = document.getElementById('hamburger');
            const navLinks = document.getElementById('nav-links');
            
            hamburger.addEventListener('click', function() {
                this.classList.toggle('active');
                navLinks.classList.toggle('active');
            });
            
            const links = navLinks.querySelectorAll('a');
            links.forEach(link => {
                link.addEventListener('click', () => {
                    hamburger.classList.remove('active');
                    navLinks.classList.remove('active');
                });
            });
        }
        
        document.addEventListener('DOMContentLoaded', () => {
            loadTournamentData();
            setupMobileMenu();
        });
    </script>
</body>
</html>
